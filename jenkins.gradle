boolean isInJeknins() {
    Map<String, String> map = System.getenv()

    if (map == null) {
        return false
    }
    String str = map.get("Path")
    if (str != null) {
        return false;
    } else {
        str = ""
        Iterator it = map.iterator();
        while (it.hasNext()) {
            str += it.next();
        }
        if (str.contains("jenkins")) {
            return true
        } else {
            return false;
        }
    }
    return false
}

task savepushinfo << {
    if (isInJeknins()) {
        ext.env = System.getenv()
        def buildNumber = env.BUILD_NUMBER?.toInteger()
        println 'NODE_LABELS : ' + env.NODE_LABELS?.toString()
        println 'JOB_NAME : ' + env.JOB_NAME?.toString()
        println 'BUILD_TYPE : ' + env.BUILD_TYPE?.toString()
        println 'BUILD_URL : ' + env.BUILD_URL?.toString()

        def path1 = '../../jobs/JenkinsTest/builds/' + buildNumber + '/archive/app/build/outputs/apk'
        def path2 = '../../jobs/JenkinsTest/builds/' + buildNumber
        File dingding = new File('./dingding.json')

        File f1 = new File(path1)
        println f1.isDirectory()
        println f1.isFile()
        f1.listFiles().findAll{
            println it.name
        }
        File f2 = new File(path2)
        println f2.isDirectory()
        println f2.isFile()
        f2.listFiles().findAll{
            println it.name
        }

    }
}

savepushinfo.dependsOn {
    tasks.findAll {
        task -> !task.name.contentEquals("savepushinfo")
    }
}