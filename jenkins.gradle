boolean isInJeknins() {
    Map<String, String> map = System.getenv()

    if (map == null) {
        return false
    }
    String str = map.get("Path")
    if (str != null) {
        //it's windows
        return false;
    } else {
        str = ""
        Iterator it = map.iterator();
        while (it.hasNext()) {
            Map.Entry entry = it.next();
            str += entry;
            println "key = " + entry.key + " value = " + entry.value
        }
        if (str.contains("jenkins")) {
            return true
        } else {
            return false;
        }
    }
    return true
}

def getJenkinsBuild() {
    boolean  flag = isInJeknins();
    if(flag){
        ext.env = System.getenv()
        ext.buildNumber = env.BUILD_NUMBER?.toInteger()
        return "$buildNumber"
    }else{
        return 0
    }
}

task hello {
    if(isInJeknins()){
        ext.env = System.getenv()
        println 'BUILD_NUMBER : ' + env.BUILD_NUMBER?.toInteger()
        println 'BRANCH_NAME : ' + env.BRANCH_NAME?.toString()
        println 'JOB_NAME : ' + env.JOB_NAME?.toString()
        println 'BUILD_URL : ' + env.BUILD_URL?.toString()
    }

}